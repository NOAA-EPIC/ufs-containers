FROM noaaepic/ubuntu20.04-intel-spack-landda:develop
WORKDIR /opt/spack-stack


WORKDIR /opt
RUN git clone -b feature/containers --recursive https://github.com/NOAA-EPIC/land-offline_workflow.git
RUN source /opt/spack-stack/.bashenv && \
    cd land-offline_workflow && \
    mkdir build && cd build && ecbuild .. && make -j 8
ENV PYTHONPATH=/opt/ioda-bundle/build/lib/pyiodaconv:/opt/ioda-bundle/build/lib/python3.8/pyioda
